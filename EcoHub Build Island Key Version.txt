-- Carga la librería de UI (Rayfield en este caso)
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Crear la ventana de UI con sistema de key habilitado
local Window = Rayfield:CreateWindow({
    Name = "Eco Hub",
    LoadingTitle = "Cargando...",
    LoadingSubtitle = "Por favor espera",
    ConfigurationSaving = {
        Enabled = false,
        FolderName = nil,
        FileName = "EcoHubConfig"
    },
    Discord = {
        Enabled = false,
        Invite = "",
        RememberJoins = true
    },
    KeySystem = true, -- Activado el sistema de key
    KeySettings = {
        Title = "Ingrese la clave",
        Subtitle = "Clave necesaria para acceder",
        Note = "Ingrese la clave que se le proporcionó",
        SaveKey = true,
        Key = "ecohub" -- Clave establecida en "ecohub"
    }
})

-- Crear pestañas
local MainTab = Window:CreateTab("Main", 4483362458)
local AvatarTab = Window:CreateTab("Avatar", 7072706623) -- Nueva pestaña "Avatar"

-- Crear secciones
local MainSection = MainTab:CreateSection("Interactable")
local AvatarSection = AvatarTab:CreateSection("Character Settings") -- Sección en Avatar

-- Botón para recoger herramientas
MainTab:CreateButton({
    Name = "Get All Tools",
    Callback = function()
        loadstring([[ 
            local player = game.Players.LocalPlayer
            local character = player.Character or player.CharacterAdded:Wait()
            local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
            local backpack = player:FindFirstChild("Backpack")
            
            if not humanoidRootPart or not backpack then
                warn("Error: No se encontró el HumanoidRootPart o el Backpack.")
                return
            end
            
            local posOriginal = humanoidRootPart.CFrame
            local itemsRecolectados = 0
            
            local function recogerItems()
                for _, objeto in pairs(game.Workspace:GetDescendants()) do
                    if objeto.Name == "SwordGiver" or objeto.Name == "GearGiver" or objeto.Name == "Giver" then
                        if objeto.Parent:FindFirstChildOfClass("Part") then
                            humanoidRootPart.CFrame = objeto.Parent:FindFirstChildOfClass("Part").CFrame + Vector3.new(0,1,0)
                            wait(0.1)
                            itemsRecolectados = itemsRecolectados + 1
                        end
                    end
                end
            end
            
            recogerItems()
            
            humanoidRootPart.CFrame = posOriginal
            print("Proceso completado. Ítems recogidos: " .. itemsRecolectados)
        ]])()
    end
})

-- Botón para Purple Hollow (Progears Imported)
MainTab:CreateButton({
    Name = "Purple Hollow (Progears Imported)",
    Callback = function()
        local args = {
            [1] = 16,
            [2] = 50
        }
        game:GetService("ReplicatedStorage").Purple:FireServer(unpack(args))
    end
})

-- Botón para Drop Cash X100
MainTab:CreateButton({
    Name = "Drop Cash X100 (Wallet in hand)",
    Callback = function()
        for i = 1, 100 do
            local args = {
                [1] = 1
            }
            game:GetService("ReplicatedStorage").WalletRemotes.DropCash:FireServer(unpack(args))
            wait(0.1)
        end
    end
})

-- Botón para equipar todas las herramientas
MainTab:CreateButton({
    Name = "Equip All Tools",
    Callback = function()
        local player = game.Players.LocalPlayer
        local backpack = player:FindFirstChild("Backpack")
        local character = player.Character or player.CharacterAdded:Wait()

        if not backpack or not character then
            warn("Error: No se encontró el Backpack o el Character.")
            return
        end

        for _, tool in pairs(backpack:GetChildren()) do
            if tool:IsA("Tool") then
                tool.Parent = character
            end
        end

        print("Todas las herramientas han sido equipadas.")
    end
})

-- TextBox para ingresar WalkSpeed
local WalkSpeedValue = 16 -- Valor por defecto

AvatarTab:CreateInput({
    Name = "Set WalkSpeed",
    PlaceholderText = "Introduce la velocidad",
    RemoveTextAfterFocusLost = false,
    Callback = function(value)
        local speed = tonumber(value)
        if speed and speed > 0 then
            WalkSpeedValue = speed
        else
            warn("Valor no válido. Introduce un número mayor a 0.")
        end
    end
})

-- Botón para aplicar WalkSpeed
AvatarTab:CreateButton({
    Name = "Apply WalkSpeed",
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoid = character:FindFirstChildOfClass("Humanoid")

        if humanoid then
            humanoid.WalkSpeed = WalkSpeedValue
            print("Velocidad de caminata establecida en: " .. WalkSpeedValue)
        else
            warn("No se encontró el Humanoid en el Character.")
        end
    end
})

-- Botón para activar vuelo con la tecla "X"
AvatarTab:CreateButton({
    Name = "X to Fly",
    Callback = function()
        local flying = false
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")

        if not humanoidRootPart then
            warn("No se encontró HumanoidRootPart")
            return
        end

        local UIS = game:GetService("UserInputService")

        UIS.InputBegan:Connect(function(input, processed)
            if processed then return end
            if input.KeyCode == Enum.KeyCode.X then
                flying = not flying
                if flying then
                    print("Vuelo activado")
                    while flying do
                        humanoidRootPart.Velocity = Vector3.new(0, 50, 0) -- Eleva al jugador
                        wait(0.1)
                    end
                else
                    print("Vuelo desactivado")
                end
            end
        end)
    end
})

-----------------------------------------------------
-- Teleport Tab

local TeleportsTab = Window:CreateTab("🏃‍♂️Teleports", nil)
local Section = TeleportsTab:CreateSection("Places", true)

local lastPosition = nil

local function savePosition()
    local Player = game.Players.LocalPlayer
    if Player and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
        lastPosition = Player.Character.HumanoidRootPart.CFrame
    end
end

local function teleportTo(position)
    local Player = game.Players.LocalPlayer
    if Player and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
        savePosition()
        Player.Character.HumanoidRootPart.CFrame = CFrame.new(position)
    end
end

TeleportsTab:CreateButton({
   Name = "Teleport to Portal",
   Info = "Teleports you to the portal.",
   Interact = 'UnChangable',
   Callback = function()
        teleportTo(Vector3.new(-292, 48, 200))
   end,
})

TeleportsTab:CreateButton({
   Name = "Teleport to Statue",
   Info = "Teleports you to the statue.",
   Interact = 'UnChangable',
   Callback = function()
        teleportTo(Vector3.new(-212, 48, 428))
   end,
})

TeleportsTab:CreateButton({
   Name = "Teleport to Nuke",
   Info = "Teleports you to the nuke.",
   Interact = 'UnChangable',
   Callback = function()
        teleportTo(Vector3.new(56, 48, 196))
   end,
})

TeleportsTab:CreateButton({
   Name = "Teleport to GrassMap",
   Info = "Teleports you to the GrassMap.",
   Interact = 'UnChangable',
   Callback = function()
        teleportTo(Vector3.new(-128, 48, 188))
   end,
})

local BackSection = TeleportsTab:CreateSection("Return", true)

TeleportsTab:CreateButton({
   Name = "Teleport Back",
   Info = "Returns you to your last saved location.",
   Interact = 'UnChangable',
   Callback = function()
        if lastPosition then
            local Player = game.Players.LocalPlayer
            if Player and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                Player.Character.HumanoidRootPart.CFrame = lastPosition
            end
        end
   end,
})
